# **1.3.4 Обработка исключений**

> [Index](./0%20Index.md)
> || [1.3 Управляющие конструкции](./1.3%20Управляющие%20конструкции.md)

Обработка исключений — это механизм, позволяющий программам продолжать работу даже при возникновении ошибок, не прерывая выполнения. Он используется для захвата, управления и обработки ошибок, которые возникают во время выполнения программы.

---

## **Основные концепции**

1. **Исключения (Exceptions):**
   Исключения возникают, когда программа сталкивается с критической ошибкой (например, деление на ноль или доступ к несуществующему элементу массива).

2. **Конструкция `try-catch-finally`:**

    - `try`: Блок кода, где могут возникнуть ошибки.
    - `catch`: Обрабатывает исключения, которые произошли в блоке `try`.
    - `finally`: Блок, который выполняется всегда, независимо от того, произошла ошибка или нет.

3. **Создание пользовательских исключений:**
   Программисты могут вызывать свои исключения с помощью `throw`.

---

### **Синтаксис**

```javascript
try {
    // Код, который может вызвать исключение
} catch (error) {
    // Обработка исключения
} finally {
    // Код, который выполнится в любом случае
}
```

---

### **Примеры кода**

#### **Пример 1: Деление на ноль**

```javascript
function divide(a, b) {
    try {
        if (b === 0) {
            throw new Error('На ноль делить нельзя!');
        }
        return a / b;
    } catch (error) {
        console.error('Ошибка:', error.message);
    } finally {
        console.log('Операция завершена.');
    }
}

divide(10, 2); // 5
divide(10, 0); // Ошибка: На ноль делить нельзя!
```

---

#### **Пример 2: Обработка отсутствия файла**

```javascript
const fs = require('fs');

function readFile(filePath) {
    try {
        const data = fs.readFileSync(filePath, 'utf-8');
        console.log('Содержимое файла:', data);
    } catch (error) {
        console.error('Ошибка при чтении файла:', error.message);
    } finally {
        console.log('Завершение операции чтения.');
    }
}

readFile('./existing-file.txt'); // Читает файл
readFile('./missing-file.txt'); // Ошибка при чтении файла
```

---

#### **Пример 3: Пользовательское исключение**

```javascript
function checkAge(age) {
    try {
        if (age < 0) {
            throw new Error('Возраст не может быть отрицательным!');
        } else if (age < 18) {
            throw new Error('Возраст меньше 18!');
        }
        console.log('Возраст принят.');
    } catch (error) {
        console.error('Ошибка:', error.message);
    }
}

checkAge(25); // Возраст принят.
checkAge(-5); // Ошибка: Возраст не может быть отрицательным!
checkAge(15); // Ошибка: Возраст меньше 18!
```

---

#### **Пример 4: Перехват конкретных типов ошибок**

```javascript
function parseJson(jsonString) {
    try {
        const data = JSON.parse(jsonString);
        console.log('Успешно разобран JSON:', data);
    } catch (error) {
        if (error instanceof SyntaxError) {
            console.error('Ошибка синтаксиса JSON:', error.message);
        } else {
            console.error('Неизвестная ошибка:', error.message);
        }
    }
}

parseJson('{"name":"John"}'); // Успешно разобран JSON
parseJson('Invalid JSON'); // Ошибка синтаксиса JSON
```

---

### **Преимущества обработки исключений**

1. Позволяет предотвратить краш приложения.
2. Улучшает читаемость кода при сложной логике.
3. Помогает централизовать обработку ошибок.
4. Обеспечивает возможность выполнения завершающего кода (`finally`).

---

### **Недостатки обработки исключений**

1. Неправильное использование может привести к запутанному коду.
2. Ловля исключений, которые можно было бы предотвратить, снижает производительность.
3. Сложность отладки, если исключения слишком общие или плохо документированы.

---

### **10 задач для закрепления**

1. Напишите функцию, которая проверяет, является ли переданная строка числом. Если нет — выбрасывайте исключение.
2. Создайте функцию, которая принимает два числа и возвращает их сумму. Если один из аргументов не число, выбрасывайте исключение.
3. Реализуйте обработку исключений при чтении файла (используйте `fs.readFile` в Node.js).
4. Напишите функцию, которая разбирает JSON-строку. При синтаксической ошибке возвращайте объект с сообщением об ошибке.
5. Реализуйте функцию, которая бросает исключение, если массив пустой.
6. Напишите программу, которая проверяет корректность введенного email. Если формат некорректный, выбрасывайте исключение.
7. Напишите функцию, которая делит два числа. Если делитель равен 0, выбрасывайте исключение и обработайте его.
8. Реализуйте игру "Угадай число". При вводе нечисловых значений выбрасывайте исключение.
9. Создайте функцию, которая принимает объект с обязательными полями. Если поле отсутствует, выбрасывайте исключение.
10. Реализуйте обработку исключений при попытке подключения к несуществующему серверу (используйте библиотеку `axios` или `fetch`).

---

Эти задачи помогут вам освоить основные подходы и практики работы с исключениями.
